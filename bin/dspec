#!/bin/sh
set -e

if [ $# -eq 0 ]
then
  echo "No arguments supplied. Defaults to 'rake default'"

  docker-compose run --rm \
    -e RAILS_ENV=test \
    web rake db:create && rake

else
  echo "Testing: $@"

  docker-compose run --rm \
    -e RAILS_ENV=test \
    web rake db:create && rspec $@
fi

# If there's a failing test, ensure to drop the test database at the end.
docker-compose run --rm \
  -e RAILS_ENV=test \
  web rake db:drop
